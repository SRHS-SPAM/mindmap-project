FROM python:3.11-slim

ENV PYTHONDONTWRITEBYTECODE=1 \
    PYTHONUNBUFFERED=1 \
    PYTHONPATH=/app

WORKDIR /app

# í•„ìš”í•œ ë””ë ‰í† ë¦¬ ìƒì„±
RUN mkdir -p /app/back /app/uploaded_images

# requirements ë¨¼ì € ë³µì‚¬ (ìºì‹± í™œìš©)
COPY requirements.txt /app/back/
RUN pip install --no-cache-dir -r /app/back/requirements.txt

# ì½”ë“œ ë³µì‚¬
COPY . /app/back/
RUN touch /app/back/__init__.py

# âœ… ë¡œê·¸ ì¶œë ¥ í™•ì¸ìš©
RUN echo "ğŸ³ Docker build completed"

# âœ… ì‹¤í–‰ ì‹œ ë¡œê·¸ ì¶œë ¥
CMD echo "ğŸš€ Starting application..." && \
    python -m uvicorn back.main:app --host 0.0.0.0 --port 8000