# Python ê³µì‹ ì´ë¯¸ì§€ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‚¬ìš©
FROM python:3.11-slim

# í•„ìš”í•œ í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (ì˜ˆì‹œ)
ENV PYTHONDONTWRITEBYTECODE 1
ENV PYTHONUNBUFFERED 1
# ğŸ’¡ í•µì‹¬ ìˆ˜ì •: Pythonì´ /app ë””ë ‰í† ë¦¬ì—ì„œ ëª¨ë“ˆì„ ì°¾ë„ë¡ ê²½ë¡œë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
ENV PYTHONPATH /app

# ì»¨í…Œì´ë„ˆì˜ ì‘ì—… ë””ë ‰í† ë¦¬ë¥¼ /appìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.
# ì´ ê²½ë¡œëŠ” í˜¸ìŠ¤íŠ¸ì˜ 'back' í´ë” ë‚´ìš©ì´ ë³µì‚¬ë  ìœ„ì¹˜ì…ë‹ˆë‹¤.
WORKDIR /app

# í˜„ì¬ ë””ë ‰í† ë¦¬(back)ì˜ ëª¨ë“  íŒŒì¼ê³¼ í´ë”ë¥¼ /appìœ¼ë¡œ ë³µì‚¬í•©ë‹ˆë‹¤.
# í˜¸ìŠ¤íŠ¸: mindmap/back/* ->  ì»¨í…Œì´ë„ˆ: /app/*
# (ì°¸ê³ : Docker Composeì˜ context: ./back ë•Œë¬¸ì— ì‹¤ì œë¡œ back í´ë” ì•ˆì˜ ë‚´ìš©ì´ ë³µì‚¬ë¨)
COPY . /app

# ì˜ì¡´ì„± ì„¤ì¹˜
RUN pip install --no-cache-dir -r requirements.txt

# ì„œë²„ ì‹¤í–‰ ëª…ë ¹
# ì´ì œ main.pyê°€ /app ë””ë ‰í† ë¦¬ì— ìˆìœ¼ë¯€ë¡œ, 'main:app'ìœ¼ë¡œ ì‹¤í–‰ ê°€ëŠ¥í•©ë‹ˆë‹¤.
CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000"]
